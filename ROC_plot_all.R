#!/usr/bin/env Rscript

library(GA)
library(kernlab)
library(ROCR)

# Read in data
height0 <- read.table("/home/visco/jjc/dissertation/PAINFREE_AID_787_v2/trainingset/HCdesmatrix-int0")
height1 <- read.table("/home/visco/jjc/dissertation/PAINFREE_AID_787_v2/trainingset/HCdesmatrix-int1")
height2 <- read.table("/home/visco/jjc/dissertation/PAINFREE_AID_787_v2/trainingset/HCdesmatrix-int2")
desmatrix.raw <- cbind(height0,height1,height2)
colnames(desmatrix.raw) <- seq(ncol(desmatrix.raw))
desmatrix <- as.matrix(desmatrix.raw)
response.raw <- read.table("/home/visco/jjc/dissertation/PAINFREE_AID_787_v2/compound_class")
response <- as.matrix(response.raw)
svm.all<-list()
pdf("svm_ROC_PAINFREE_AID_787_v2.pdf")
load("10fold/jjc0/svm.min")
svm.all<-append(svm.all,svm.min)
load("10fold/jjc1/svm.min")
svm.all<-append(svm.all,svm.min)
load("10fold/jjc10/svm.min")
svm.all<-append(svm.all,svm.min)
load("10fold/jjc11/svm.min")
svm.all<-append(svm.all,svm.min)
load("10fold/jjc12/svm.min")
svm.all<-append(svm.all,svm.min)
load("10fold/jjc13/svm.min")
svm.all<-append(svm.all,svm.min)
load("10fold/jjc16/svm.min")
svm.all<-append(svm.all,svm.min)
load("10fold/jjc17/svm.min")
svm.all<-append(svm.all,svm.min)
load("10fold/jjc18/svm.min")
svm.all<-append(svm.all,svm.min)
load("10fold/jjc19/svm.min")
svm.all<-append(svm.all,svm.min)
load("10fold/jjc20/svm.min")
svm.all<-append(svm.all,svm.min)
load("10fold/jjc21/svm.min")
svm.all<-append(svm.all,svm.min)
load("10fold/jjc22/svm.min")
svm.all<-append(svm.all,svm.min)
load("10fold/jjc24/svm.min")
svm.all<-append(svm.all,svm.min)
load("10fold/jjc25/svm.min")
svm.all<-append(svm.all,svm.min)
load("10fold/jjc26/svm.min")
svm.all<-append(svm.all,svm.min)
load("10fold/jjc27/svm.min")
svm.all<-append(svm.all,svm.min)
load("10fold/jjc28/svm.min")
svm.all<-append(svm.all,svm.min)
load("10fold/jjc29/svm.min")
svm.all<-append(svm.all,svm.min)
load("10fold/jjc3/svm.min")
svm.all<-append(svm.all,svm.min)
load("10fold/jjc30/svm.min")
svm.all<-append(svm.all,svm.min)
load("10fold/jjc31/svm.min")
svm.all<-append(svm.all,svm.min)
load("10fold/jjc32/svm.min")
svm.all<-append(svm.all,svm.min)
load("10fold/jjc33/svm.min")
svm.all<-append(svm.all,svm.min)
load("10fold/jjc34/svm.min")
svm.all<-append(svm.all,svm.min)
load("10fold/jjc35/svm.min")
svm.all<-append(svm.all,svm.min)
load("10fold/jjc36/svm.min")
svm.all<-append(svm.all,svm.min)
load("10fold/jjc37/svm.min")
svm.all<-append(svm.all,svm.min)
load("10fold/jjc38/svm.min")
svm.all<-append(svm.all,svm.min)
load("10fold/jjc39/svm.min")
svm.all<-append(svm.all,svm.min)
load("10fold/jjc4/svm.min")
svm.all<-append(svm.all,svm.min)
load("10fold/jjc40/svm.min")
svm.all<-append(svm.all,svm.min)
load("10fold/jjc41/svm.min")
svm.all<-append(svm.all,svm.min)
load("10fold/jjc42/svm.min")
svm.all<-append(svm.all,svm.min)
load("10fold/jjc43/svm.min")
svm.all<-append(svm.all,svm.min)
load("10fold/jjc44/svm.min")
svm.all<-append(svm.all,svm.min)
load("10fold/jjc45/svm.min")
svm.all<-append(svm.all,svm.min)
load("10fold/jjc46/svm.min")
svm.all<-append(svm.all,svm.min)
load("10fold/jjc47/svm.min")
svm.all<-append(svm.all,svm.min)
load("10fold/jjc6/svm.min")
svm.all<-append(svm.all,svm.min)
load("10fold/jjc7/svm.min")
svm.all<-append(svm.all,svm.min)
load("10fold/jjc8/svm.min")
svm.all<-append(svm.all,svm.min)
load("10fold/jjc9/svm.min")
svm.all<-append(svm.all,svm.min)
testmatrix<-desmatrix[,as.numeric(gsub("X","",colnames(svm.all[[1]]@xmatrix[[1]])))]
response.pred<-predict(svm.all[[1]],testmatrix,type="decision")
svm.ROC.pred<-list()
svm.ROC.pred[[1]]<-prediction(response.pred,response)
svm.ROC.perf<-list()
svm.ROC.perf[[1]]<-performance(svm.ROC.pred[[1]],measure="tpr",x.measure="fpr")
svm.AUC<-vector()
svm.AUC[1]<-performance(svm.ROC.pred[[1]],measure="auc")@y.values[[1]]
plot(svm.ROC.perf[[1]])
if (length(svm.all)>1){
    for (i in 2:length(svm.all)){
        testmatrix<-desmatrix[,as.numeric(gsub("X","",colnames(svm.all[[i]]@xmatrix[[1]])))]
        response.pred=predict(svm.all[[i]],testmatrix,type="decision")
        svm.ROC.pred[[i]]<-prediction(response.pred,response)
        svm.ROC.perf[[i]]<-performance(svm.ROC.pred[[i]],measure="tpr",x.measure="fpr")
        plot(svm.ROC.perf[[i]],add=T)
	svm.AUC[i]<-performance(svm.ROC.pred[[i]],measure="auc")@y.values[[1]]
    }
}
save(svm.ROC.pred,file="svm.ROC.pred")
save(svm.ROC.perf,file="svm.ROC.perf")
save(svm.AUC,file="svm.AUC")
dev.off()

desmatrix <- desmatrix[,scan(text="1 2 5 6 7 8 9 11 12 18 25 26 30 36 37 38 40 42 44 45 46 47 48 49 51 53 54 55 56 58 68 69 70 71 76 77 78 79 80 81 82 83 84 85 86 91 98 101 102 108 113 114 117 120 123 125 126 127 128 131 133 136 139 142 147 148 169 193 196 198 205 207 229 234 240 246 252 273 275 281 282 310 322 332 339 356 357 362 378 381 382 383 385 391 393 398 402 411 412 417 418 421 424 427 429 435 436 438 451 452 455 457 463 465 467 476 478 480 483 485 493 496 502 506 513 514 517 522 525 536 540 542 548 549 564 572 577 581 582 583 584 585 591 595 600 611 618 621 625 632 634 637 638 639 641 642 643 646 649 650 653 654 659 660 664 676 685 694 699 702 703 709 710 714 716 731 741 747 773 774 783 787 788 789 791 793 794 796 798 799 800 801 803 805 839 845 846 847 848 887 889 908 938 940 942 948 956 980 983 984 985 986 987 991 992 993 1002 1003 1004 1005 1010 1014 1015 1029 1030 1031 1036 1050 1066 1067")]
pdf("svr_ROC_PAINFREE_AID_787_v2.pdf")
svr.all<-list()
load("10fold/jjc30/svr.min")
svr.all<-append(svr.all,svr.min)
testmatrix<-desmatrix[,as.numeric(gsub("X","",colnames(svr.all[[1]]@xmatrix)))]
response.pred<-predict(svr.all[[1]],testmatrix,type="response")
svr.ROC.pred<-list()
svr.ROC.pred[[1]]<-prediction(10^(response.pred*0.625094888427359+0.772659140996664),-response)
svr.ROC.perf<-list()
svr.ROC.perf[[1]]<-performance(svr.ROC.pred[[1]],measure="tpr",x.measure="fpr")
plot(svr.ROC.perf[[1]])
if (length(svr.all)>1){
    for (i in 2:length(svr.all)){
        testmatrix<-desmatrix[,as.numeric(gsub("X","",colnames(svr.all[[i]]@xmatrix)))]
        response.pred=predict(svr.all[[i]],testmatrix,type="response")
        svr.ROC.pred[[i]]<-prediction(10^(response.pred*0.625094888427359+0.772659140996664),-response)
        svr.ROC.perf[[i]]<-performance(svr.ROC.pred[[i]],measure="tpr",x.measure="fpr")
        plot(svr.ROC.perf[[i]],add=T)
    }
}
save(svr.ROC.pred,file="svr.ROC.pred")
save(svr.ROC.perf,file="svr.ROC.perf")
dev.off()
